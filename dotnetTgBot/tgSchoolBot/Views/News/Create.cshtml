@model News
@{
    ViewData["Title"] = "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å";
}

<h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å –∏–ª–∏ –æ—Ç—á–µ—Ç</h2>

<form method="post" action="/News/Create" enctype="multipart/form-data">
    @Html.AntiForgeryToken()

    <div class="mb-3">
        <label for="ClassId" class="form-label">–ö–ª–∞—Å—Å</label>
        @Html.DropDownList("ClassId", (IEnumerable<SelectListItem>)ViewBag.Classes, new { @class = "form-select", required = "required" })
    </div>
    
    <div class="mb-3">
        <label for="Type" class="form-label">–¢–∏–ø</label>
        @{
            var selectedType = Model?.Type ?? NewsType.News;
        }
        <select class="form-select" id="Type" name="Type" required>
            @if (selectedType == NewsType.News)
            {
                <option value="News" selected>üì∞ –ù–æ–≤–æ—Å—Ç—å</option>
                <option value="Report">üìä –û—Ç—á–µ—Ç</option>
            }
            else
            {
                <option value="News">üì∞ –ù–æ–≤–æ—Å—Ç—å</option>
                <option value="Report" selected>üìä –û—Ç—á–µ—Ç</option>
            }
        </select>
    </div>

    <div class="mb-3">
        <label for="Title" class="form-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
        <input type="text" class="form-control" id="Title" name="Title" value="@Model?.Title" required>
    </div>

    <div class="mb-3" id="content-block">
        <label for="Content" class="form-label">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</label>
        <textarea class="form-control" id="Content" name="Content" rows="10">@Model?.Content</textarea>
    </div>

    <div class="mb-3" id="report-file-block" style="display:@(Model?.Type == NewsType.Report ? "block" : "none")">
        <label for="reportFile" class="form-label">–§–∞–π–ª –æ—Ç—á–µ—Ç–∞</label>
        <input type="file" class="form-control" id="reportFile" name="reportFile" accept="*/*">
    </div>

    <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        <a href="/Home" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
    </div>
</form>

<script>
    (function() {
        const typeSelect = document.getElementById('Type');
        const fileBlock = document.getElementById('report-file-block');
        const contentBlock = document.getElementById('content-block');
        const contentInput = document.getElementById('Content');
        const fileInput = document.getElementById('reportFile');
        function toggleFile() {
            const isReport = typeSelect.value === 'Report';
            fileBlock.style.display = isReport ? 'block' : 'none';
            contentBlock.style.display = isReport ? 'none' : 'block';
            // content –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –æ—Ç—á–µ—Ç–∞
            contentInput.required = !isReport;
            // —Ñ–∞–π–ª –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –æ—Ç—á–µ—Ç–∞
            fileInput.required = isReport;
        }
        typeSelect.addEventListener('change', toggleFile);
        toggleFile();
    })();
</script>

